# 문서/레포트 자동 포맷 생성기 - 시스템 아키텍처

## 1. 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────┐
│                    사용자 입력 (Input)                    │
│  - 문서 종류, 제출 대상, 주제, 분량, 문체, 참고 조건      │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│                  [1] Input Parser                        │
│  - 입력 검증 및 정규화                                    │
│  - 기본값 추론 및 보완                                    │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│              [2] Document Analyzer                      │
│  - 문서 목적 분석 (설명/설득/보고/평가)                   │
│  - 제출 대상별 난이도 및 문체 조절                        │
│  - 평가 기준 추출                                         │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│            [3] Structure Generator                       │
│  - 문서 유형별 표준 구조 선택                             │
│  - 분량 분배 계산 (각 섹션별 비율)                        │
│  - 목차 생성                                              │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│            [4] Content Generator                         │
│  - LLM 추상화 레이어를 통한 내용 생성                     │
│  - 각 섹션별 실제 완성 문장 작성                          │
│  - 논리적 흐름 및 연결성 보장                             │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│                [5] Formatter                             │
│  - 문서 포맷팅 (마크다운/텍스트)                          │
│  - 제출용 체크포인트 생성                                 │
│  - 최종 출력 생성                                         │
└──────────────────────┬──────────────────────────────────┘
                       │
                       ▼
┌─────────────────────────────────────────────────────────┐
│                    최종 문서 출력                          │
│  - 전체 문서 개요                                         │
│  - 자동 생성된 문서 본문                                  │
│  - 제출용 체크포인트                                      │
└─────────────────────────────────────────────────────────┘
```

## 2. 핵심 모듈 상세 설계

### 2.1 Input Parser
**책임:**
- 사용자 입력 파싱 및 검증
- 누락된 필드에 대한 기본값 추론
- 입력 정규화 (대소문자, 공백 등)

**입력 형식:**
```python
{
    "document_type": "과제 레포트",
    "target_audience": "대학교",
    "topic": "인공지능의 미래",
    "length": "A4 3장",
    "writing_style": "학술적",
    "required_keywords": ["AI", "머신러닝"],
    "excluded_content": [],
    "evaluation_criteria": ["논리성", "객관성"]
}
```

### 2.2 Document Analyzer
**책임:**
- 문서 목적 분류 (설명/설득/보고/평가)
- 제출 대상별 난이도 매핑
- 문체 및 어휘 수준 결정

**출력:**
```python
{
    "purpose": "설명용",
    "difficulty_level": "대학생",
    "vocabulary_level": "학술용어_포함",
    "sentence_complexity": "중간",
    "evaluation_focus": ["논리성", "객관성"]
}
```

### 2.3 Structure Generator
**책임:**
- 문서 유형별 표준 구조 템플릿 선택
- 전체 분량을 섹션별로 분배
- 목차 생성

**구조 템플릿 예시:**
- 레포트: 서론(20%) / 본론(60%) / 결론(20%)
- 보고서: 배경(15%) / 문제점(20%) / 분석(30%) / 해결방안(25%) / 기대효과(10%)
- 논술: 주장(10%) / 근거1(25%) / 근거2(25%) / 반론(20%) / 재반박(10%) / 결론(10%)

### 2.4 Content Generator
**책임:**
- LLM을 통한 실제 내용 생성
- 섹션별 완성 문장 작성
- 논리적 연결성 보장
- 키워드 포함 및 제외 조건 처리

**LLM 추상화:**
- LLM 인터페이스 정의
- 구현체: OpenAI, Anthropic 등 교체 가능

### 2.5 Formatter
**책임:**
- 마크다운/텍스트 포맷팅
- 번호 매기기 및 제목 스타일 적용
- 체크포인트 생성

## 3. 데이터 흐름

1. **입력 단계**: 사용자 입력 → Input Parser → 정규화된 입력 데이터
2. **분석 단계**: 정규화된 입력 → Document Analyzer → 문서 메타데이터
3. **구조화 단계**: 문서 메타데이터 → Structure Generator → 구조 스키마
4. **생성 단계**: 구조 스키마 → Content Generator → 원시 내용
5. **포맷팅 단계**: 원시 내용 → Formatter → 최종 문서

## 4. 확장성 고려사항

- **LLM 교체**: LLMProvider 인터페이스로 추상화
- **출력 형식**: Formatter를 확장하여 PDF/DOCX/HWP 지원
- **프리셋 시스템**: 학교/회사별 포맷 프리셋 저장 및 로드
- **첨삭 기능**: 평가 기준 기반 자동 첨삭 모듈 추가 가능
